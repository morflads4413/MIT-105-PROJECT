{% extends 'base.html' %}

{% block title %}Book Appointment{% endblock %}

{% block content %}
<div class="card">
    <div style="text-align: center; margin-bottom: 2rem;">
        <h2>üìù Book New Appointment</h2>
        <p style="color: #6c757d;">Fill out the form below to schedule your Entrance Exam</p>
    </div>

    <form method="post" style="max-width: 600px; margin: 0 auto;">
        {% csrf_token %}
        
        <div class="form-group">
            <label for="{{ form.student.id_for_label }}">
                üë§ Student Name
            </label>
            {{ form.student }}
            {% if form.student.errors %}
                <div class="alert alert-error">
                    {{ form.student.errors }}
                </div>
            {% endif %}
            <small style="color: #6c757d; margin-top: 0.5rem; display: block;">
                Enter your full name.
            </small>
        </div>

        <div class="form-group">
            <label for="{{ form.contact_number.id_for_label }}">
                üì± Mobile Number
            </label>
            <input type="tel" 
                   name="{{ form.contact_number.name }}" 
                   id="{{ form.contact_number.id_for_label }}"
                   class="form-control"
                   style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; background: white; transition: border-color 0.3s ease;"
                   placeholder="Enter 11-digit mobile number"
                   pattern="[0-9]{11}"
                   maxlength="11"
                   minlength="11"
                   required>
            {% if form.contact_number.errors %}
                <div class="alert alert-error">
                    {{ form.contact_number.errors }}
                </div>
            {% endif %}
            <small style="color: #6c757d; margin-top: 0.5rem; display: block;">
                Enter your 11-digit mobile number (e.g., 09123456789) for appointment confirmation and updates.
            </small>
        </div>

        <div class="form-group">
            <label for="{{ form.date.id_for_label }}">
                üìÖ Choose Date
            </label>
            <input type="date" 
                   name="{{ form.date.name }}" 
                   id="{{ form.date.id_for_label }}"
                   class="form-control"
                   style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; background: white; transition: border-color 0.3s ease;"
                   min="{{ today|date:'Y-m-d' }}"
                   required>
            {% if form.date.errors %}
                <div class="alert alert-error">
                    {{ form.date.errors }}
                </div>
            {% endif %}
            <small style="color: #6c757d; margin-top: 0.5rem; display: block;">
                Select your preferred appointment date (available from today).
            </small>
        </div>

        <div class="form-group">
            <label for="{{ form.time.id_for_label }}">
                üïê Choose Time
            </label>
            <select name="{{ form.time.name }}" 
                    id="{{ form.time.id_for_label }}"
                    class="form-control"
                    style="width: 100%; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; font-size: 16px; background: white; transition: border-color 0.3s ease;"
                    required>
                <option value="">Select a time slot</option>
                <optgroup label="Morning Session (8:00 AM - 12:00 PM)">
                    <option value="08:00">8:00 AM</option>
                    <option value="08:30">8:30 AM</option>
                    <option value="09:00">9:00 AM</option>
                    <option value="09:30">9:30 AM</option>
                    <option value="10:00">10:00 AM</option>
                    <option value="10:30">10:30 AM</option>
                    <option value="11:00">11:00 AM</option>
                    <option value="11:30">11:30 AM</option>
            
                </optgroup>
                <optgroup label="Afternoon Session (1:00 PM - 5:00 PM)">
                    <option value="13:00">1:00 PM</option>
                    <option value="13:30">1:30 PM</option>
                    <option value="14:00">2:00 PM</option>
                    <option value="14:30">2:30 PM</option>
                    <option value="15:00">3:00 PM</option>
                    <option value="15:30">3:30 PM</option>
                    <option value="16:00">4:00 PM</option>
         
                </optgroup>
            </select>
            {% if form.time.errors %}
                <div class="alert alert-error">
                    {{ form.time.errors }}
                </div>
            {% endif %}
            <small style="color: #6c757d; margin-top: 0.5rem; display: block;">
                Select your preferred time slot (Morning: 8:00 AM - 12:00 PM, Afternoon: 1:00 PM - 5:00 PM).
            </small>
        </div>

        <div style="text-align: center; margin-top: 2rem;">
            <button type="submit" class="btn" style="min-width: 200px;">
                üìÖ Book Appointment
            </button>
        </div>
    </form>
</div>

<div class="card">
    <h3 style="color: #667eea; margin-bottom: 1rem;">‚ÑπÔ∏è Booking Guidelines</h3>
    <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1rem;">
        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px;">
            <h4 style="color: #667eea; margin-bottom: 0.5rem;">üìÖ Scheduling</h4>
            <p style="font-size: 0.9rem; color: #6c757d;">
                Appointments are available from today onwards. Please book at least 2 hours in advance.
            </p>
        </div>
        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px;">
            <h4 style="color: #667eea; margin-bottom: 0.5rem;">‚è∞ Duration</h4>
            <p style="font-size: 0.9rem; color: #6c757d;">
                Sessions typically last 30-45 minutes. Please arrive on time for your appointment.
            </p>
        </div>
        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px;">
            <h4 style="color: #667eea; margin-bottom: 0.5rem;">üïê Time Slots</h4>
            <p style="font-size: 0.9rem; color: #6c757d;">
                Morning: 8:00 AM - 12:00 PM | Afternoon: 1:00 PM - 5:00 PM (Lunch break: 12:00 PM - 1:00 PM)
            </p>
        </div>
        <div style="background: #f8f9fa; padding: 1rem; border-radius: 8px;">
            <h4 style="color: #667eea; margin-bottom: 0.5rem;">üì± Contact</h4>
            <p style="font-size: 0.9rem; color: #6c757d;">
                We'll contact you via SMS to confirm your appointment and provide any updates.
            </p>
        </div>
    </div>
</div>

<style>
.form-control:focus {
    outline: none;
    border-color: #667eea !important;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
}

input[type="date"]::-webkit-calendar-picker-indicator {
    background-color: #667eea;
    padding: 5px;
    cursor: pointer;
    border-radius: 3px;
}

input[type="tel"] {
    font-family: monospace;
}

select.form-control {
    cursor: pointer;
}

select.form-control option {
    padding: 8px;
}

select.form-control optgroup {
    font-weight: bold;
    color: #667eea;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
    // Set minimum date to today (allow same-day bookings)
    const today = new Date();
    const todayStr = today.toISOString().split('T')[0];
    
    const dateInput = document.getElementById('{{ form.date.id_for_label }}');
    if (dateInput) {
        dateInput.min = todayStr;
    }
    
    // Add focus effects
    const inputs = document.querySelectorAll('.form-control');
    inputs.forEach(input => {
        input.addEventListener('focus', function() {
            this.style.borderColor = '#667eea';
        });
        
        input.addEventListener('blur', function() {
            this.style.borderColor = '#e9ecef';
        });
    });
    
    // Format phone number as user types
    const phoneInput = document.getElementById('{{ form.contact_number.id_for_label }}');
    if (phoneInput) {
        phoneInput.addEventListener('input', function(e) {
            // Remove all non-digit characters
            let value = e.target.value.replace(/\D/g, '');
            
            // Limit to 11 digits
            if (value.length > 11) {
                value = value.slice(0, 11);
            }
            
            // Update the input value
            e.target.value = value;
            
            // Add visual feedback for valid/invalid length
            if (value.length === 11) {
                e.target.style.borderColor = '#28a745';
                e.target.style.boxShadow = '0 0 0 3px rgba(40, 167, 69, 0.1)';
            } else if (value.length > 0) {
                e.target.style.borderColor = '#dc3545';
                e.target.style.boxShadow = '0 0 0 3px rgba(220, 53, 69, 0.1)';
            } else {
                e.target.style.borderColor = '#e9ecef';
                e.target.style.boxShadow = 'none';
            }
        });
        
        // Reset styling on blur if empty
        phoneInput.addEventListener('blur', function(e) {
            if (e.target.value.length === 0) {
                e.target.style.borderColor = '#e9ecef';
                e.target.style.boxShadow = 'none';
            }
        });
    }
});
</script>
{% endblock %} 